<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WASM Audio Experiment using Rust</title>
</head>

<body>

  <h1>Multi-threading, WebAssembly-driven and SIMD-optimized Audio Engine Experiment</h1>

  <p>
    This simple experiment demonstrates how to use WebAssembly to create a multithreading, SIMD-optimized audio engine
    in Rust. The architecture is quite unique, as the Web Audio API is only used for one
    <code>AudioWorkletProcessor</code>
    that receives the audio data from the WebAssembly-based Audio Engine via an atomic, lock-free, wait-free, and
    zero-copy <code>RingBuffer</code> that wraps a <code>SharedArrayBuffer</code> that is shared between the
    WebAssembly, the
    AudioWorklet thread, and the main thread. This audio engine adds less than 0.001ms overhead for forwarding
    the signal to the AudioContext, suggesting that it is very efficient and leaves a lot of headroom for complex,
    realtime audio processing. There is also no heap allocation in the critical path and therefore, no GC. All mutable
    state is managed atomically.
  </p>

  <div>
    <strong>Buffer Size:</strong>
    <select id="bufferSize">
      <option value="128">128 (2.9ms @ 44.1kHz)</option>
      <option value="256">256 (5.8ms @ 44.1kHz)</option>
      <option value="512" selected>512 (11.6ms @ 44.1kHz)</option>
      <option value="1024">1024 (23.2ms @ 44.1kHz)</option>
      <option value="2048">2048 (46.4ms @ 44.1kHz)</option>
      <option value="4096">4096 (92.8ms @ 44.1kHz)</option>
    </select>
  </div>

  <div>
    <strong>MIDI Note:</strong> <input type="range" min="20" max="84" step="1" value="36" style="width: 400px"
           id="freq" />
  </div>

  <div>
    <strong>Volume:</strong> <input type="range" min="0" max="1" value="0.15" step="0.05" style="width: 400px"
           id="amp" />
  </div>

  <div>
    <button id="play">â–¶ Play</button>
  </div>

  <div>
    <strong>Stats:</strong>
    <pre id="stats">-</pre>
  </div>

  <script type="module" src="/src/index.ts"></script>
</body>

</html>